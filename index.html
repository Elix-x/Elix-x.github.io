<!doctype html>
<html>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
/**
 * Returns a number whose value is limited to the given range.
 *
 * Example: limit the output of this computation to between 0 and 255
 * (x * 255).clamp(0, 255)
 *
 * @param {Number} min The lower boundary of the output range
 * @param {Number} max The upper boundary of the output range
 * @returns A number in the range [min, max]
 * @type Number
 */
Number.prototype.clamp = function(min, max){
  return Math.min(Math.max(this, min), max)
}
</script>
<script>
function onLogoClick(logo){
	logo.classList.toggle("logo-container")
	logo.classList.toggle("logo-container-animated")
	/*transitionEvent && logo.addEventListener(transitionEvent, function() {
		console.log('Transition complete!  This is the callback, no library needed!');
	});*/
	//TODO 
	setTimeout(function(){logo.style.display = "none"}, 1000)
}

// Scrolling

function reApplyScrollPagesSizes(){
	var width = $(window).width()
	var height = $(window).height()
	$(".scroll-page").get().forEach(function(spage){
		spage.style.height = height + "px"
	})
	
	scrollTo(scrollSnapID, 0, true)
}

$(function() {
	reApplyScrollPagesSizes()
	$(window).resize(reApplyScrollPagesSizes);
});

// Snapping

const scrollSnapTime = 500
var scrollSnapID = 0
var scrolling = false

function getScrollSnapPoints(){
	return $(".scroll-snap").get()
}
	
function preventDefault(e){
	e = e || window.event;
	if(e.preventDefault) e.preventDefault();
	e.returnValue = false;  
}

window.onwheel = window.onmousewheel = function(event){
	preventDefault(event)
	scrollTo(scrollSnapID + (event.deltaY > 0 ? 1 : -1), scrollSnapTime, false)
}

window.ontouchmove = function(event){
	preventDefault(event)
	scrollTo(scrollSnapID + (event.deltaY > 0 ? 1 : -1), scrollSnapTime, false)
}

// left: 37, up: 38, right: 39, down: 40,
// spacebar: 32, pageup: 33, pagedown: 34, end: 35, home: 36
var keys = {38: -1, 40: +1, 32: +1, 34: +1, 33: -1, 35: Number.POSITIVE_INFINITY, 36:Number.NEGATIVE_INFINITY};
window.onkeydown = function(event){
	var offset = keys[event.keyCode]
	if(offset != undefined){
		preventDefault(event)
		scrollTo(scrollSnapID + offset, scrollSnapTime, false)
	}
}

function scrollTo(id, time, force){
	if(scrolling && !force) return;
	var snaps = getScrollSnapPoints()
	id = id.clamp(0, snaps.length-1)
	if(id == scrollSnapID && !force) return;
	
	scrolling = true
	$('html, body').animate({
		scrollTop: $(snaps[id]).offset().top
	}, time, "swing", function(){scrollSnapID = id;scrolling = false;});
}

</script>
<head>
<meta charset="utf-8">
<title>index</title>
<link href="index.css" rel="stylesheet" type="text/css">
</head>

<body>
<div class="page-scroller">
<!--<div class="logo-container" id="logo" onClick="onLogoClick(this)"></div>-->
<div class="scroll-page scroll-snap">This is a text!</div>
<div class="scroll-page scroll-snap">This is a first scroll text!</div>
<div class="scroll-page scroll-snap">This is a second scroll text!</div>
</div>
</body>
</html>
