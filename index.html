<!doctype html>
<html>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
<script>
/**
 * Returns a number whose value is limited to the given range.
 *
 * Example: limit the output of this computation to between 0 and 255
 * (x * 255).clamp(0, 255)
 *
 * @param {Number} min The lower boundary of the output range
 * @param {Number} max The upper boundary of the output range
 * @returns A number in the range [min, max]
 * @type Number
 */
Number.prototype.clamp = function(min, max){
  return Math.min(Math.max(this, min), max)
}

function getUrlQueryParam(name, url){
	if(!url) url = window.location.href;
	name = name.replace(/[\[\]]/g, "\\$&");
	var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
		results = regex.exec(url);
	if(!results) return null;
	if(!results[2]) return '';
	return decodeURIComponent(results[2].replace(/\+/g, " "));
}

function setUrlQueryParam(key, value){
	baseUrl = [location.protocol, '//', location.host, location.pathname].join('');
	urlQueryString = document.location.search;
	var newParam = key + '=' + value,
		params = '?' + newParam;

	// If the "search" string exists, then build params from it
	if(urlQueryString){
		keyRegex = new RegExp('([\?&])' + key + '[^&]*');
		// If param exists already, update it
		if(urlQueryString.match(keyRegex) !== null){
			params = urlQueryString.replace(keyRegex, "$1" + newParam);
		} else { // Otherwise, add it to end of query string
			params = urlQueryString + '&' + newParam;
		}
	}
	window.history.replaceState({}, "", baseUrl + params);
}
</script>
<script>
//Logo

var logoed = true
function getLogo(){
	return $(".logo").get()[0];
}
function onLogoClick(logo){
	logoem()
}
function logoem(){
	logo = getLogo()
	if(logoed) return;
	logo.classList.toggle("logo")
	logo.classList.toggle("logo-animated")
	/*transitionEvent && logo.addEventListener(transitionEvent, function() {
		console.log('Transition complete!  This is the callback, no library needed!');
	});*/
	//TODO 
	setTimeout(function(){logo.style.display = "none";logoed = true;}, 1000)
}

// Scrolling

function reApplyScrollPagesSizes(){
	var width = $(window).width()
	var height = $(window).height()
	$(".scroll-page").get().forEach(function(spage){
		spage.style.height = height + "px"
	})
	
	if(logoed) scrollTo(getScrollSnapId(), 0, true)
}

$(function() {
	reApplyScrollPagesSizes()
	$(window).resize(reApplyScrollPagesSizes);
});

// Snapping

const scrollSnapTime = 500
const scrollSnapParam = "snap"
var scrolling = false

function getScrollSnapId(){
//	return scrollSnapId
	return Number(getUrlQueryParam(scrollSnapParam)) || 0
}

function setScrollSnapId(snap){
	setUrlQueryParam(scrollSnapParam, snap)
}

function getScrollSnapPoints(){
	return $(".scroll-snap").get()
}
	
function preventDefault(e){
	e = e || window.event;
	if(e.preventDefault) e.preventDefault();
	e.returnValue = false;  
}

window.onwheel = window.onmousewheel = function(event){
	preventDefault(event)
	scrollTo(getScrollSnapId() + (event.deltaY > 0 ? 1 : -1), scrollSnapTime, false)
}

window.ontouchmove = function(event){
	preventDefault(event)
	scrollTo(getScrollSnapId() + (event.deltaY > 0 ? 1 : -1), scrollSnapTime, false)
}

// left: 37, up: 38, right: 39, down: 40,
// spacebar: 32, pageup: 33, pagedown: 34, end: 35, home: 36
var keys = {38: -1, 40: +1, 32: +1, 34: +1, 33: -1, 35: Number.POSITIVE_INFINITY, 36:Number.NEGATIVE_INFINITY};
window.onkeydown = function(event){
	var offset = keys[event.keyCode]
	if(offset != undefined){
		preventDefault(event)
		scrollTo(getScrollSnapId() + offset, scrollSnapTime, false)
	}
}

function scrollTo(id, time, force){
	if(!logoed) return logoem();
	
	if(scrolling && !force) return;
	var snaps = getScrollSnapPoints()
	id = id.clamp(0, snaps.length-1)
	if(id == getScrollSnapId() && !force) return;
	
	scrolling = true
	$('html, body').animate({
		scrollTop: $(snaps[id]).offset().top
	}, time, "swing", function(){
		setScrollSnapId(id)
		scrolling = false
		$(window).trigger("scroll-snap-end", id)
	});
}

// Contents

function getContents(){
	return $(".contents")
}

function genContents(typeClass, contentFromPage, onComplete, force = false, fadeOut = 150, fadeIn = 150){
	var contents = getContents()
	if(!force && contents.hasClass(typeClass)) return;
	var onFadeOut = function(){
		contents.removeClass("interpunct").removeClass("text").addClass(typeClass)
		contents.html("")
		$(".scroll-page").get().forEach(function(spage, index){
			contents.html(function(i, ohtml){
				return ohtml + "<tr><td class=\"contents-element\">" + contentFromPage($(spage), index) + "</td></tr>"
			})
		})
		if(fadeIn > 0) contents.fadeIn(fadeIn, onComplete); else onComplete();
	}
	if(fadeOut > 0) contents.fadeOut(fadeOut, onFadeOut); else onFadeOut();
}

function genInterpunctContents(force, fadeOut, fadeIn){
	genContents("interpunct", function(spage){return "â€¢";}, function(){
		$(".contents-element").get().forEach(function(aelem, i){
			$(aelem).click(genTextContents)
			if(i == getScrollSnapId()) $(aelem).toggleClass("contents-element-current")
		})
	}, force, fadeOut, fadeIn)
}

function genTextContents(force, fadeOut, fadeIn){
	genContents("text", function(spage){return spage.attr("contents-title");}, function(){
		$(".contents-element").get().forEach(function(aelem, i){
			var elem = $(aelem)
			elem.hover(function(){
				elem.css("text-decoration", "underline")
			}, function(){
				elem.css("text-decoration", "none")
			})
			elem.on('click touchend', function(e){
				scrollTo(i, scrollSnapTime, false)
				if(e.type == "touchend") genInterpunctContents()
			})
			if(i == getScrollSnapId()) elem.toggleClass("contents-element-current")
		})
	}, force, fadeOut, fadeIn)
}

function reposContents(){
	getContents().css("top", (($(window).height() - getContents().height())/2) + "px")
}

$(function() {
	genInterpunctContents()
	reposContents()
	$(window).resize(reposContents)
	getContents().hover(function(){genTextContents()}, function(){genInterpunctContents()})
});

$(window).on("scroll-snap-end", function(){
	if(getContents().hasClass("text")) genTextContents(true, 0, 0);
	else genInterpunctContents(true, 0, 0);
});

// Widgets

const widgetAnimTime = 500

function getWidgets(){
	return $(".widgets")
}

function reposWidgets(){
	getWidgets().css("top", (($(window).height() - getWidgets().height())/2) + "px")
	$(".twitter-timeline").attr("style", "height: " + $(window).height() + "px")
}

function closeWidgets(){
	getWidgets().animate({
		left: -$(window).width()
	}, widgetAnimTime, "swing")
}

function openWidgets(){
	getWidgets().animate({
		left: 0
	}, widgetAnimTime, "swing")
}

$(function() {
	reposWidgets()
	$(window).resize(reposWidgets)
});

function getWidget(){
	return $("#widget")
}

function isWidgetOpen(){
	return !getWidget().is(":empty")
}

function closeWidget(){
	if(isWidgetOpen()){
		getWidget().animate({
			left: -$(window).width()
		}, widgetAnimTime, "swing", function(){
			getWidget().empty()
		})
		openWidgets()
	}
}

function openWidget(src){
	closeWidget()
	getWidget().html(src + '<div class="close-widget" onClick="closeWidget()"></div>')
	getWidget().animate({
		left: 0
	}, widgetAnimTime, "swing")
	closeWidgets()
}

function openTwitterWidget(){
	openWidget('<a class="twitter-timeline" data-height="' + $(window).height() + '" data-theme="dark" data-chrome="transparent noscrollbar nofooter noborders" href="https://twitter.com/Elix_x_mc?ref_src=twsrc%5Etfw">Tweets by Elix_x_mc</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"><' + '/script>')
}

function openDiscordWidget(){
	openWidget("<embed height='100%' width='100%' src='https://widgetbot.io/embed/219142420112211981/219142420112211981/0002/' />")
}

var settings = []
function setting(setGen){
	settings.push(setGen)
}

function openSettingsWidget(){
	var settingsStr = '<div class="settings-widget">'
	for(var setting of settings) settingsStr += setting()
	settingsStr += '</div>'
	openWidget(settingsStr)
}

// Themes
const themes = {
	'dark': '#212921',
	'light': '#B0FBB0'
}
const defaultTheme = 'dark'

function getTheme(){
	var theme = Cookies.get('theme')
	return theme == undefined ? defaultTheme : theme
}

function setTheme(theme = defaultTheme){
	Cookies.set('theme', theme)
	$("head").append('<link href="themes/' + theme + '.css" rel="stylesheet" type="text/css">')
}

$(function(){
	setTheme(getTheme())
	setting(function(){
	/*
		<table class="theme-table"><tr><td><div style="background-color: aqua">&nbsp;</div></td><td><div style="background-color: yellowgreen">&nbsp;</div></td></tr></table>
	*/
		var str = '<table class="theme-table"><tr>'
		for(var theme in themes) str += '<td><div style="background-color: ' + themes[theme] + '" onClick="setTheme(\'' + theme + '\')">&nbsp;</div></td>'
		str += '</tr></table>'
		return str
	})
})

// Bio

function reposQuote(){
	var quote = $(".quote")
	quote.css("padding-top", (($(window).height() - 2*quote.height())/2) + "px")
}

$(function() {
	reposQuote()
	$(window).resize(reposQuote)
});
</script>
<head>
<meta charset="utf-8">
<title>Elix'x Web</title>
<link href="index.css" rel="stylesheet" type="text/css">
</head>
<link rel="shortcut icon" type="image/png" href="favicon.png"/>
<body tracingsrc="logo/512.png" tracingopacity="100">
<table class="contents"></table>
<table class="widgets">
	<tbody>
		<tr>
			<td><img src="assets/gear.svg" alt="settings" onClick="openSettingsWidget()"></td>
		</tr>
		<tr>
			<td><img src="logo/twitter.svg" alt="twitter" onClick="openTwitterWidget()"></td>
		</tr>
		<tr>
			<td><img src="logo/discord.svg" alt="discord" onClick="openDiscordWidget()"></td>
		</tr>
	</tbody>
</table>
<div id="widget" style="left: -100vw"></div>
<div class="page-scroller">
<!--<div class="logo scroll-page" onClick="onLogoClick(this)"></div>-->
<div class="scroll-page scroll-snap" contents-title="Home">
<div id="home-table" style="display:flex;justify-content:center;align-items:center;">
<!--<div id="home-table-container">-->
		<table>
		<tbody>
			<tr>
				<td><a href=""><img src="logo/discord.svg" alt="discrod"></a></td>
				<td><a href="https://github.com/Elix-x/"><img src="logo/github.png" alt="github"></a></td>
				<td>&nbsp;</td>
			</tr>
			<tr>
				<td></td>
				<td><a href="index.html"><img src="logo/512.png" alt="logo"></a></td>
				<td><a href="https://twitter.com/Elix_x_mc"><img src="logo/twitter.svg" alt="twitter"></a></td>
			</tr>
			<tr>
				<td>&nbsp;</td>
				<td>&nbsp;</td>
				<td><a href="https://www.youtube.com/channel/UC_ir0P3v-v8olULsfoE-nxw"><img src="logo/youtube.png" alt="youtube"></a></td>
			</tr>
		</tbody>
		</table>
	</div>
</div>
<div class="scroll-page scroll-snap" contents-title="Bio">
<div id="bio">
	<div class="quote">
		<p>"<i>Elix_x is a rather elusive species. It takes great patience to observe, even in it's presumably natural habitat.</i>"<br><span style="float:right;">-laszlogasd</span></p>
	</div>
	<table class="contact">
	<tbody>
		<tr>
			<td><a href="https://twitter.com/Elix_x_mc"><img src="logo/twitter.svg" alt="twitter"></a></td>
			<td><a href="https://github.com/Elix-x/"><img src="logo/github.png" alt="github"></a></td>
			<td><a href=""><img src="logo/discord.svg" alt="discord"></a></td>
		</tr>
	</tbody>
	</table>
</div>
</div>
</div>
</body>
</html>
